{% extends 'main.html' %}
{% load static %}
{% load i18n %}
{% block main_content %}

<div class="grid grid-cols-12 gap-x-4">
    <!-- Start Bread Crumb Section -->
    <div class="col-span-full card flex-center-btween sm:flex-center-between sm:flex-row">
            <div>
                <h5 class="card-title">{% trans "Teacher" %}</h5>
                <ul class="flex items-center flex-wrap gap-1.5 *:flex-center *:gap-1.5 leading-none text-gray-900 dark:text-dark-text mt-2">
                    <li class="text-primary-500 after:font-remix after:flex-center after:font-thin after:text-gray-900 after:size-5 after:content-['\ea6d'] after:translate-y-[1.4px] last:after:hidden [&amp;.current-page]:text-gray-500 dark:[&amp;.current-page]:text-dark-text-two">
                        <a href="{% url 'index' %}">{% trans "Home" %}</a>
                    </li>
                    <li class="text-primary-500 after:font-remix after:flex-center after:font-thin after:text-gray-900 after:size-5 after:content-['\ea6d'] after:translate-y-[1.4px] last:after:hidden [&amp;.current-page]:text-gray-500 dark:[&amp;.current-page]:text-dark-text-two">
                        <a href="{% url 'teacher_list' %}">{% trans "Teachers" %}</a>
                    </li>
                    <li class="text-primary-500 after:font-remix after:flex-center after:font-thin after:text-gray-900 after:size-5 after:content-['\ea6d'] after:translate-y-[1.4px] last:after:hidden [&amp;.current-page]:text-gray-500 dark:[&amp;.current-page]:text-dark-text-two current-page">
                        <a href="#">{% trans "Teacher Dashboard" %}</a>
                    </li>
                </ul>
            </div>
            {% if LMS_URL %}
            <a href="{{ LMS_URL }}/user/profile.php?id={{ teacher.user_id }}" target="_blank" class="btn b-solid btn-primary-solid">
                <i class="ri-external-link-line mr-1"></i> {% trans "View in Moodle" %}
            </a>
            {% endif %}
    </div>
    <!-- End Bread Crumb Section -->

    <!-- Start Teacher Profile Preview Section -->
    <div class="col-span-full lg:col-span-4 card p-0">
        <div class="bg-white dark:bg-dark-card rounded-15 overflow-hidden dk-theme-card-square">
            <div class="relative w-full h-[150px]">
                <img src="{% static 'images/profile/cover.png' %}" alt="cover-image" class="w-full h-full">
                <label for="thumbnailsrc" class="file-container bg-white bg-no-repeat bg-cover absolute left-1/2 -translate-x-1/2 -bottom-[calc(theme('spacing.ins-pro-img')_/_2)] w-[calc(theme('spacing.ins-pro-img')_+_5px)] h-[theme('spacing.ins-pro-img')] border-2 border-white dark:border-dark-border-two rounded-20 dk-theme-card-square"
                    style="background-image: url('{% static 'images/user/profile-img.png' %}');">
                    <input type="file" id="thumbnailsrc" hidden class="img-src peer/file">
                    <span class="absolute bottom-0 right-0 flex-center size-5 rounded-50 border border-white dark:border-dark-border-two text-primary-500 bg-primary-200">
                        <i class="ri-circle-fill text-success text-[5px]"></i>
                    </span>
                </label>
            </div>
            <div class="mt-7 px-6 text-center">
                <div class="py-5">
                    <div class="flex-center">
                        <h4 class="text-[22px] leading-none text-heading font-semibold relative">
                            {{ teacher.firstname }} {{ teacher.lastname }}
                        </h4>
                    </div>
                    {% if teacher.city and teacher.country %}
                        <p class="font-spline_sans leading-[1.62] text-heading dark:!text-dark-text mt-2.5">{{ teacher.city }}, {{ teacher.country }}</p>
                    {% endif %}
                </div>
                <div class="py-5 border-t border-gray-200 dark:border-dark-border text-left">
                    <div class="flex-center-between">
                        <h6 class="text-gray-500 dark:text-dark-text leading-none font-semibold">{% trans "About" %}</h6>
                    </div>
                    <ul class="flex flex-col gap-y-3 *:flex *:gap-x-2.5 *:leading-none *:text-gray-500 dark:*:text-dark-text *:font-medium mt-4">
                        <li>
                            <i class="ri-mail-line text-inherit"></i>
                            <div>{% trans "Email" %}: <span class="text-heading dark:!text-dark-text"> {{ teacher.email }}</span>
                            </div>
                        </li>
                        <li>
                            <i class="ri-user-line text-inherit"></i>
                            <div>{% trans "Username" %}: <span class="text-heading dark:!text-dark-text"> {{ teacher.username }}</span>
                            </div>
                        </li>
                        {% if teacher.lastlogin %}
                        <li>
                            <i class="ri-calendar-line text-inherit"></i>
                            <div>{% trans "Last Login" %}: <span class="text-heading dark:!text-dark-text"> {{ teacher.lastlogin|date:"Y-m-d H:i" }}</span>
                            </div>
                        </li>
                        {% endif %}
                        {% if teacher.timecreated %}
                        <li>
                            <i class="ri-time-line text-inherit"></i>
                            <div>{% trans "Member Since" %}: <span class="text-heading dark:!text-dark-text"> {{ teacher.timecreated|date:"Y-m-d" }}</span>
                            </div>
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End Teacher Profile Preview Section -->

    <!-- Start Teacher Course Overview Section -->
    <div class="col-span-full lg:col-span-8 card">
        <div class="grid grid-cols-12 gap-4">
            <div class="col-span-full md:col-span-6 lg:col-span-4 dk-border-one p-5 mb-0">
                <div class="size-11 flex-center bg-[#F7F3FF] dark:bg-dark-icon rounded-10 mb-4">
                    <img src="{% static 'images/icons/course-overview/progress.svg' %}" alt="icon" class="dark:brightness-[5]">
                </div>
                <p class="text-gray-500 dark:text-dark-text-two font-medium leading-none mb-2">{% trans "Active Courses" %}</p>
                <div class="counter-value text-primary-500 text-[32px] font-semibold leading-none" data-value="{{ teacher.active_courses }}">0</div>
            </div>
            <div class="col-span-full md:col-span-6 lg:col-span-4 dk-border-one p-5 mb-0">
                <div class="size-11 flex-center bg-[#F7F3FF] dark:bg-dark-icon rounded-10 mb-4">
                    <img src="{% static 'images/icons/course-overview/complete.svg' %}" alt="icon" class="dark:brightness-[5]">
                </div>
                <p class="text-gray-500 dark:text-dark-text-two font-medium leading-none mb-2">{% trans "Archived Courses" %}</p>
                <div class="counter-value text-primary-500 text-[32px] font-semibold leading-none" data-value="{{ teacher.archived_courses }}">0</div>
            </div>
            <div class="col-span-full md:col-span-6 lg:col-span-4 dk-border-one p-5 mb-0">
                <div class="size-11 flex-center bg-[#F7F3FF] dark:bg-dark-icon rounded-10 mb-4">
                    <img src="{% static 'images/icons/course-overview/certificate.svg' %}" alt="icon" class="dark:brightness-[5]">
                </div>
                <p class="text-gray-500 dark:text-dark-text-two font-medium leading-none mb-2">{% trans "Total Courses" %}</p>
                <div class="counter-value text-primary-500 text-[32px] font-semibold leading-none" data-value="{{ teacher.total_courses }}">0</div>
            </div>
        </div>
    </div>
    <!-- End Teacher Course Overview Section -->

    <!-- Start Teacher Course List Table -->
    <div class="col-span-full lg:col-span-6 2xl:col-span-6 card px-0 card">
        <div class="flex-center-between px-3">
            <h6 class="card-title">{% trans "Teaching Courses" %}</h6>
        </div>
        <!-- Course Table -->
        <div class="overflow-x-auto scrollbar-table mt-5 px-3">
            <table class="table-auto w-full whitespace-nowrap text-left text-gray-500 dark:text-dark-text font-medium leading-none">
                <thead>
                    <tr>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square">{% trans "Course Title" %}</th>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square">{% trans "Role" %}</th>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square">{% trans "Status" %}</th>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square w-10">{% trans "Action" %}</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200 dark:divide-dark-border">
                    {% for course in teacher.enrollments %}
                        <tr>
                            <td class="flex items-center gap-2 px-3.5 py-4">
                                <div>
                                    <h6 class="text-lg leading-none text-heading dark:!text-dark-text font-semibold mb-1.5 line-clamp-1">
                                        {{ course.course_name }}
                                    </h6>
                                    <div class="flex items-center gap-2">
                                        <p class="font-normal text-xs text-gray-900">{{ course.category_path }}</p>
                                    </div>
                                </div>
                            </td>
                            <td class="px-3.5 py-4">
                                {% if course.role_name == 'editingteacher' %}
                                    <span class="badge badge-primary-outline">{% trans "Editing Teacher" %}</span>
                                {% else %}
                                    <span class="badge badge-secondary-outline">{% trans "Teacher" %}</span>
                                {% endif %}
                            </td>
                            <td class="px-3.5 py-4">
                                {% if course.visible %}
                                    <span class="badge badge-success-outline">{% trans "Active" %}</span>
                                {% else %}
                                    <span class="badge badge-disable-outline">{% trans "Hidden" %}</span>
                                {% endif %}
                            </td>
                            <td class="px-3.5 py-4">
                                {% if LMS_URL %}
                                <a href="{{ LMS_URL }}/course/view.php?id={{ course.course_id }}" target="_blank" class="btn b-solid btn-primary-solid btn-sm">
                                    <i class="ri-external-link-line mr-1"></i> {% trans "View" %}
                                </a>
                                {% else %}
                                <span class="text-gray-400">{% trans "N/A" %}</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="4" class="px-3.5 py-4 text-center text-gray-500">
                                {% trans "No courses found" %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Start Recent Course Access -->
    <div class="col-span-full lg:col-span-6 2xl:col-span-6 card px-0 card">
        <div class="flex-center-between px-3">
            <h6 class="card-title">{% trans "Recent Course Access" %}</h6>
            <p class="text-sm text-gray-500">{% trans "Last 30 days" %}</p>
        </div>
        <!-- Recent Access Table -->
        <div class="overflow-x-auto scrollbar-table mt-5 px-3">
            <table class="table-auto w-full whitespace-nowrap text-left text-gray-500 dark:text-dark-text font-medium leading-none">
                <thead>
                    <tr>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square">{% trans "Course" %}</th>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square">{% trans "Last Access" %}</th>
                        <th class="px-3.5 py-4 bg-[#E6F6FD] dark:bg-dark-card-two first:rounded-l-lg last:rounded-r-lg dk-theme-card-square w-10">{% trans "Action" %}</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200 dark:divide-dark-border">
                    {% for access in last_access_course_list %}
                        <tr>
                            <td class="flex items-center gap-2 px-3.5 py-4">
                                <div>
                                    <h6 class="text-lg leading-none text-heading dark:!text-dark-text font-semibold mb-1.5 line-clamp-1">
                                        {{ access.course_name }}
                                    </h6>
                                    <div class="flex items-center gap-2">
                                        <p class="font-normal text-xs text-gray-900">{{ access.category_name }}</p>
                                    </div>
                                </div>
                            </td>
                            <td class="px-3.5 py-4">
                                <span class="text-sm">{{ access.timeaccess_formatted }}</span>
                            </td>
                            <td class="px-3.5 py-4">
                                {% if LMS_URL %}
                                <a href="{{ LMS_URL }}/course/view.php?id={{ access.course_id }}" target="_blank" class="btn b-solid btn-primary-solid btn-sm">
                                    <i class="ri-external-link-line mr-1"></i> {% trans "View" %}
                                </a>
                                {% else %}
                                <span class="text-gray-400">{% trans "N/A" %}</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="3" class="px-3.5 py-4 text-center text-gray-500">
                                {% trans "No recent course access found" %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Include ApexCharts library -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<!-- Include dashboard JS -->
<script src="{% static 'js/pages/dashboard-admin-lms.js' %}"></script>

{% endblock %}